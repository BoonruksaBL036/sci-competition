services:
    server:
      build:
        context: ./server
        dockerfile: Dockerfile.server
      ports:
        - "5000:5000"
      volumes:
        - "./server:/app"
        - "/app/node_modules"
      command: nodemon --legacy-watch index
      restart: always
      environment:
        - DATABASE_URL=postgres://postgres:postgres@db:5432/sci_db
        - HOST=db
        - USER=postgres
        - PASSWORD=postgres
        - DB=sci_db
        - DB_PORT=5432
        - SERVER_PORT=5000
      depends_on:
      - db
    # client:
    #   build:
    #     context: ./client
    #     dockerfile: Dockerfile.client
    #   ports:
    #     - "5173:5173"
    #   volumes:
    #     - ""./client:./app"
    #     - "/app/node_modules"
    #   environment:
    #     - CHOKIDAR_USEPOLLING=true
    #   depends_on:
    #     - server
    db:
      image: postgres:16
      restart: always
      ports:
        - "5433:5432"
      environment:
        - POSGRES_USER=postgres
        - POSGRES_PASSWORD=postgres
        - POSTGRES_DB=sci_db
      volumes:
        - pgdata:/var/lib/postgresql/data
volumes:
  pgdata: